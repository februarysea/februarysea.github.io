---
import { getCurrentTimeInShanghai, formatTimeForShanghai } from "../lib/helpers";
import FlipCard from "./FlipCard.astro";
---

<script>
  import { onCleanup, onMount } from "solid-js";
  import { formatTimeForShanghai } from "../lib/helpers";

  let interval: ReturnType<typeof setInterval>;

  function updateClock() {
    const timeDisplay = document.getElementById("timeDisplay");
    const now = new Date();

    if (timeDisplay) {
      timeDisplay.textContent = formatTimeForShanghai(now);
      timeDisplay.setAttribute("datetime", now.toISOString());
    }
  }

  onMount(() => {
    interval = setInterval(updateClock, 1000);
  });

  onCleanup(() => {
    clearInterval(interval);
  });
</script>

<FlipCard colSpan="lg:col-span-2" rowSpan="md:row-span-2" color="bg-[#050505]" borderColor="border-amber-500">
  <div slot="front" class="w-full h-full flex flex-col justify-between">
      <h2 class="text-xl font-bold font-sans">Time Zone</h2>
      <div class="w-full h-[calc(100%-28px)] flex justify-center items-center">
        <time
          class="text-3xl xl:text-4xl xl:whitespace-nowrap font-sans font-bold tracking-widest"     datetime=""     id="timeDisplay"
        >
          {formatTimeForShanghai(getCurrentTimeInShanghai())}
        </time>
      </div>
  </div>
  
  <div slot="back" class="w-full h-full flex flex-col justify-center items-center">
      <p class="text-gray-400 text-xs mb-1 font-sans">Location</p>
      <p class="text-lg font-bold font-sans">China, Guangzhou</p>
      <p class="text-xs text-gray-500 mt-2 font-sans">UTC+8 CST</p>
  </div>
</FlipCard>
